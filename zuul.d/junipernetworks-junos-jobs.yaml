---
# ansible-collections/junipernetworks.junos jobs

- job:
    name: ansible-network-junos-appliance
    parent: ansible-network-appliance-base
    pre-run: playbooks/ansible-network-junos-appliance/pre.yaml
    run: playbooks/ansible-network-junos-appliance/run.yaml
    required-projects:
      - name: github.com/ansible/ansible-zuul-jobs

- job:
    name: ansible-network-junos-vsrx-appliance
    parent: ansible-network-junos-appliance
    host-vars:
      vsrx3-18.4R1:
        ansible_network_os: junos
    nodeset: vsrx3-18.4R1-python36

- job:
    name: ansible-network-junos-vqfx-appliance
    parent: ansible-network-junos-appliance
    host-vars:
      vqfx-18.1R3:
        ansible_network_os: junos
    nodeset: vqfx-18.1R3-python36

- job:
    name: ansible-test-network-integration-junos-vsrx
    abstract: true
    dependencies:
      - name: build-ansible-collection
        soft: true
    parent: ansible-network-junos-vsrx-appliance
    pre-run:
      - playbooks/ansible-test-base/pre.yaml
      - playbooks/ansible-test-network-integration-base/pre.yaml
    run: playbooks/ansible-test-base/run.yaml
    post-run:
      - playbooks/ansible-test-network-integration-base/post.yaml
      - playbooks/ansible-test-base/post.yaml
    required-projects:
      - name: github.com/ansible/ansible
      - name: github.com/ansible-collections/junipernetworks.junos
    timeout: 10800
    vars:
      ansible_collections_repo: github.com/ansible-collections/junipernetworks.junos
      ansible_test_command: network-integration
      ansible_test_integration_targets: "junos_.* netconf_.*"

- job:
    name: ansible-test-units-junos-python27
    parent: ansible-test-units-base-python27
    required-projects:
      - name: github.com/ansible-collections/junipernetworks.junos
    vars:
      ansible_collections_repo: github.com/ansible-collections/junipernetworks.junos

- job:
    name: ansible-test-units-junos-python36
    parent: ansible-test-units-base-python36
    required-projects:
      - name: github.com/ansible-collections/junipernetworks.junos
    vars:
      ansible_collections_repo: github.com/ansible-collections/junipernetworks.junos

- job:
    name: ansible-test-units-junos-python37
    parent: ansible-test-units-base-python37
    required-projects:
      - name: github.com/ansible-collections/junipernetworks.junos
    vars:
      ansible_collections_repo: github.com/ansible-collections/junipernetworks.junos

- job:
    name: ansible-test-units-junos-python38
    parent: ansible-test-units-base-python38
    required-projects:
      - name: github.com/ansible-collections/junipernetworks.junos
    vars:
      ansible_collections_repo: github.com/ansible-collections/junipernetworks.junos

- job:
    name: ansible-test-network-integration-junos-vsrx-netconf
    parent: ansible-test-network-integration-junos-vsrx
    abstract: true
    nodeset: vsrx3-18.4R1-python27
    vars:
      ansible_test_skip_tags: local,network_cli

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli
    parent: ansible-test-network-integration-junos-vsrx
    abstract: true
    nodeset: vsrx3-18.4R1-python27
    vars:
      ansible_test_skip_tags: local,netconf

- job:
    name: ansible-test-network-integration-junos-vsrx-python27
    parent: ansible-test-network-integration-junos-vsrx
    nodeset: vsrx3-18.4R1-python27
    vars:
      ansible_test_python: 2.7

- job:
    name: ansible-test-network-integration-junos-vsrx-netconf-python27
    parent: ansible-test-network-integration-junos-vsrx-netconf
    nodeset: vsrx3-18.4R1-python27
    vars:
      ansible_test_python: 2.7
      ansible_test_split_in: 2

- job:
    name: ansible-test-network-integration-junos-vsrx-netconf-python27-scenario01
    parent: ansible-test-network-integration-junos-vsrx-netconf-python27
    vars:
      ansible_test_do_number: 1

- job:
    name: ansible-test-network-integration-junos-vsrx-netconf-python27-scenario02
    parent: ansible-test-network-integration-junos-vsrx-netconf-python27
    vars:
      ansible_test_do_number: 2

- job:
    name: ansible-test-network-integration-junos-vsrx-netconf-python27-stable211
    parent: ansible-test-network-integration-junos-vsrx-netconf
    nodeset: vsrx3-18.4R1-python27
    required-projects:
      - name: github.com/ansible/ansible
        override-checkout: stable-2.11
    vars:
      ansible_test_python: 2.7

- job:
    name: ansible-test-network-integration-junos-vsrx-netconf-python27-stable29
    parent: ansible-test-network-integration-junos-vsrx-netconf
    nodeset: vsrx3-18.4R1-python27
    required-projects:
      - name: github.com/ansible/ansible
        override-checkout: stable-2.11
    vars:
      ansible_test_python: 2.7

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli-python27-stable211
    parent: ansible-test-network-integration-junos-vsrx-network_cli
    nodeset: vsrx3-18.4R1-python27
    required-projects:
      - name: github.com/ansible/ansible
        override-checkout: stable-2.11
    vars:
      ansible_test_python: 2.7

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli-python27-stable29
    parent: ansible-test-network-integration-junos-vsrx-network_cli
    nodeset: vsrx3-18.4R1-python27
    required-projects:
      - name: github.com/ansible/ansible
        override-checkout: stable-2.11
    vars:
      ansible_test_python: 2.7

- job:
    name: ansible-test-network-integration-junos-vsrx-netconf-python38
    parent: ansible-test-network-integration-junos-vsrx-netconf
    nodeset: vsrx3-18.4R1-python38
    vars:
      ansible_test_python: 3.8

- job:
    name: ansible-test-network-integration-junos-vsrx-netconf-python36-stable211
    parent: ansible-test-network-integration-junos-vsrx-netconf
    nodeset: vsrx3-18.4R1-python36
    required-projects:
      - name: github.com/ansible/ansible
        override-checkout: stable-2.11
    vars:
      ansible_test_python: 3.6

- job:
    name: ansible-test-network-integration-junos-vsrx-netconf-python36-stable29
    parent: ansible-test-network-integration-junos-vsrx-netconf
    nodeset: vsrx3-18.4R1-python36
    required-projects:
      - name: github.com/ansible/ansible
        override-checkout: stable-2.11
    vars:
      ansible_test_python: 3.6

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli-python38
    parent: ansible-test-network-integration-junos-vsrx-network_cli
    nodeset: vsrx3-18.4R1-python38
    vars:
      ansible_test_python: 3.8

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli-libssh-python38
    parent: ansible-test-network-integration-junos-vsrx-network_cli-python38
    vars:
      ansible_test_network_cli_ssh_type: libssh

- job:
    name: ansible-test-network-integration-junos-vsrx-netconf-python38-stable212
    parent: ansible-test-network-integration-junos-vsrx-netconf
    nodeset: vsrx3-18.4R1-python38
    required-projects:
      - name: github.com/ansible/ansible
        override-checkout: stable-2.12
    vars:
      ansible_test_python: 3.8

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli-python38-stable212
    parent: ansible-test-network-integration-junos-vsrx-network_cli
    nodeset: vsrx3-18.4R1-python38
    required-projects:
      - name: github.com/ansible/ansible
        override-checkout: stable-2.12
    vars:
      ansible_test_python: 3.8

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli-libssh-python38-stable212
    parent: ansible-test-network-integration-junos-vsrx-network_cli-python38-stable212
    vars:
      ansible_test_network_cli_ssh_type: libssh

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli-python36-stable211
    parent: ansible-test-network-integration-junos-vsrx-network_cli
    nodeset: vsrx3-18.4R1-python36
    required-projects:
      - name: github.com/ansible/ansible
        override-checkout: stable-2.11
    vars:
      ansible_test_python: 3.6

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli-libssh-python36-stable211
    parent: ansible-test-network-integration-junos-vsrx-network_cli-python36-stable211
    vars:
      ansible_test_network_cli_ssh_type: libssh

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli-python36-stable29
    parent: ansible-test-network-integration-junos-vsrx-network_cli
    nodeset: vsrx3-18.4R1-python36
    required-projects:
      - name: github.com/ansible/ansible
        override-checkout: stable-2.11
    vars:
      ansible_test_python: 3.6

- job:
    name: ansible-test-network-integration-junos-vsrx-network_cli-libssh-python36-stable29
    parent: ansible-test-network-integration-junos-vsrx-network_cli-python36-stable29
    vars:
      ansible_test_network_cli_ssh_type: libssh

- job:
    name: ansible-test-network-integration-junos-vsrx-python36
    parent: ansible-test-network-integration-junos-vsrx
    nodeset: vsrx3-18.4R1-python36
    vars:
      ansible_test_python: 3.6

- job:
    name: ansible-test-network-integration-junos-vsrx-python38
    parent: ansible-test-network-integration-junos-vsrx
    nodeset: vsrx3-18.4R1-python38
    vars:
      ansible_test_python: 3.8

# ansible-ee
- job:
    name: ansible-ee-integration-junos-vsxr-latest
    parent: ansible-ee-tests
    pre-run:
      - playbooks/ansible-ee/integration/pre.yaml
      - playbooks/ansible-network-junos-appliance/pre.yaml
    run: playbooks/ansible-ee/integration/run.yaml
    vars:
      ansible_runner_container_version: latest
      container_image_tests:
        - integration
      ansible_test_collections: true
      test_ansible_ssh_private_key_file: ~/.ssh/id_ecdsa
      test_ansible_network_cli_ssh_type: libssh
      ansible_test_integration_targets: "junos_.*"
    nodeset: vsrx3-18.4R1-python36
    host-vars:
      vsrx3-18.4R1:
        ansible_network_os: junos

# ansible-test-network-integration-junos-vsrx-netconf-python27-stable211
- job:
    name: ansible-ee-integration-junos-vsxr-netconf-python27-stable2.11
    parent: ansible-ee-integration-junos-vsxr-latest
    vars:
      ansible_runner_container_version: stable-2.11-devel
      ansible_test_python: 2.7

# ansible-test-network-integration-junos-vsrx-netconf-python27-stable29
- job:
    name: ansible-ee-integration-junos-vsxr-netconf-python27-stable2.9
    parent: ansible-ee-integration-junos-vsxr-latest
    vars:
      ansible_runner_container_version: stable-2.9-devel
      ansible_test_python: 2.7

# ansible-test-network-integration-junos-vsrx-network_cli-python27-stable211
- job:
    name: ansible-ee-integration-junos-vsxr-network_cli-python27-stable2.11
    parent: ansible-ee-integration-junos-vsxr-latest
    vars:
      ansible_runner_container_version: stable-2.11-devel
      ansible_test_network_cli_ssh_type: libssh
      ansible_test_python: 2.7

# ansible-test-network-integration-junos-vsrx-network_cli-python27-stable29
- job:
    name: ansible-ee-integration-junos-vsxr-network_cli-python27-stable2.9
    parent: ansible-ee-integration-junos-vsxr-latest
    vars:
      ansible_runner_container_version: stable-2.9-devel
      ansible_test_network_cli_ssh_type: libssh
      ansible_test_python: 2.7

# ansible-test-network-integration-junos-vsrx-netconf-python38
# NOTE(Gonéri): Not sure if we need this one
#- job:
#    name: ansible-ee-integration-junos-vsxr-network_cli-python38-latest
#    parent: ansible-ee-integration-junos-vsxr-latest
#    vars:
#      ansible_test_python: 3.8

# ansible-test-network-integration-junos-vsrx-netconf-python38-stable212
- job:
    name: ansible-ee-integration-junos-vsxr-netconf-python38-stable2.12
    parent: ansible-ee-integration-junos-vsxr-latest
    vars:
      ansible_runner_container_version: stable-2.12-devel
      ansible_test_python: 3.8

# ansible-test-network-integration-junos-vsrx-netconf-python36-stable29
- job:
    name: ansible-ee-integration-junos-vsxr-netconf-python36-stable2.9
    parent: ansible-ee-integration-junos-vsxr-latest
    vars:
      ansible_runner_container_version: stable-2.9-devel
      ansible_test_python: 3.6

# ansible-test-network-integration-junos-vsrx-network_cli-python38
- job:
    name: ansible-ee-integration-junos-vsxr-network_cli-python38-latest
    parent: ansible-ee-integration-junos-vsxr-latest
    vars:
      ansible_test_python: 3.8
      ansible_test_network_cli_ssh_type: libssh

# ansible-test-network-integration-junos-vsrx-network_cli-python38-stable212
- job:
    name: ansible-ee-integration-junos-vsxr-network_cli-python38-stable.2.12
    parent: ansible-ee-integration-junos-vsxr-latest
    vars:
      ansible_runner_container_version: stable-2.12-devel
      ansible_test_python: 3.8
      ansible_test_network_cli_ssh_type: libssh

# ansible-test-network-integration-junos-vsrx-network_cli-python36-stable211
- job:
    name: ansible-ee-integration-junos-vsxr-network_cli-python36-stable.2.11
    parent: ansible-ee-integration-junos-vsxr-latest
    vars:
      ansible_runner_container_version: stable-2.11-devel
      ansible_test_python: 3.6
      ansible_test_network_cli_ssh_type: libssh

# ansible-test-network-integration-junos-vsrx-network_cli-python36-stable29
- job:
    name: ansible-ee-integration-junos-vsxr-network_cli-python36-stable.2.9
    parent: ansible-ee-integration-junos-vsxr-latest
    vars:
      ansible_runner_container_version: stable-2.9-devel
      ansible_test_python: 3.6
      ansible_test_network_cli_ssh_type: libssh

# NOTE(Gonéri): it looks like we already run these scenario.
# ansible-test-network-integration-junos-vsrx-network_cli-libssh-python38
# ansible-test-network-integration-junos-vsrx-network_cli-libssh-python38-stable212
# ansible-test-network-integration-junos-vsrx-network_cli-libssh-python36-stable29
# ansible-test-network-integration-junos-vsrx-network_cli-libssh-python36-stable211
