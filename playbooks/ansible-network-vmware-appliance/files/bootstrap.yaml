---
# - hosts: vcenter
#   tasks:
#     - command: sudo service-control --status
#       register: service_status
#     - debug: var=service_status
- hosts: controller
  connection: local
  tasks:
    - debug: var=hostvars.vcenter
    - uri:
        url: "https://{{ hostvars['vcenter']['nodepool']['interface_ip'] }}"
        validate_certs: false
      register: uri_result
      ignore_errors: true
    - debug: var=uri_result
    - name: "wait for ABC to come up"
      uri:
        url: "https://{{ hostvars['vcenter']['nodepool']['interface_ip'] }}"
        status_code: 200
        validate_certs: false
      register: result
      until: result.status == 200
      retries: 60
      delay: 1
    - debug: var=result